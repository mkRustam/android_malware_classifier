import graph.graph_predict as graph_approach
import n_gram.secondrandomforest as opcode_approach

apk_file_location = '/home/mkr/Desktop/projects/python/databases/cic_and_mal_2017/apks/test_fam/adware_31ab90bce315cd8d47e9551d371fa289.apk'

class_name, prediction_probability, prediction_probability_all = graph_approach.predict(apk_file_location=apk_file_location)

print prediction_probability

if prediction_probability < 0.5:
    class_name, prediction_probability, prediction_probability_all = opcode_approach.predict(apk_file_location=apk_file_location)
    if prediction_probability < 0.5:
        print 'Unknown class'

print '----------------------------'
print 'File: %s' % apk_file_location
print 'Class: %s' % class_name
print 'Probability: %s' % str(prediction_probability)
print prediction_probability_all
print '----------------------------'
