class GraphPoint(object):
    list_safe_classes = (
        'android.',
        'androidx.',
        'java.',
        'google.',
        'javax.',
        'xml.',
        'apache.',
        'junit.',
        'json.',
        'dom.',
        'dalvik.',
        'com.google.',
        'kotlin.',
        'kotlinx.',
    )

    def show(self):
        print "Class Name: " + self.className + "\n" "Method Name: " + self.methodName + "\n" + "Type: " + self.whomDefined

    def __init__(self, externalMethod, classType=None):
        # clear class name
        self.className = externalMethod.get_class_name().encode('utf-8')
        if self.className.startswith('L'):
            self.className = self.className[1:]
        if self.className.endswith('.'):
            self.className = self.className[:-1]
        self.className = self.className.replace('/', '.').replace(';', '').split('$')[0]

        # clear methodName
        self.methodName = externalMethod.get_name().encode('utf-8')

        # init who defined this class (user or android, google, ...)
        self.whomDefined = "self_defined"
        for definer in self.list_safe_classes:
            if self.className.startswith(definer):
                self.whomDefined = definer
        if self.whomDefined.startswith('L'):
            self.whomDefined = self.whomDefined[1:]
        if self.whomDefined.endswith('.'):
            self.whomDefined = self.whomDefined[:-1]

        self.classType = classType

    def get_point(self, apk):
        if self.whomDefined == "self_defined":
            s = self.get_class_type(apk)
            if s == None:
                s = 'None'
            return self.get_class_type(apk)
        else:
            return '%s' % (self.className.split('$')[0])

    def get_class_type(self, apk):
        for c in apk.get_receivers():
            if self.className == c:
                return "RECEIVER"

        for c in apk.get_activities():
            if self.className == c:
                return "ACTIVITY"

        for c in apk.get_services():
            if self.className == c:
                return "SERVICE"

        return "CLASS"
