def display_services_features(apk):
    print ''
    print 'Services features'
    for ser in apk.get_services():
        print '[%s]: %s' % (ser, apk.get_intent_filters('service', ser))


def display_receivers_features(apk):
    print ''
    print 'Receivers features'
    for rec in apk.get_receivers():
        print '[%s]: %s' % (rec, apk.get_intent_filters('receiver', rec))


def display_activity_features(apk):
    print ''
    print 'Activities features'
    for act in apk.get_activities():
        print '[%s]: %s' % (act, apk.get_intent_filters('activity', act))


def extract_intent_filters(apk, type_name, type_list):
    res = []
    for type_item in type_list:
        type_item_ifs = apk.get_intent_filters(type_name, type_item).get('action')
        if type_item_ifs is not None:
            for type_item_if in type_item_ifs:
                res.append(type_item_if)
    return res


def get_all_intent_filters(apk):
    intent_filters = []
    intent_filters.extend(extract_intent_filters(apk, 'service', apk.get_services()))
    intent_filters.extend(extract_intent_filters(apk, 'receiver', apk.get_receivers()))
    intent_filters.extend(extract_intent_filters(apk, 'activity', apk.get_activities()))
    return intent_filters


def display_all_intent_filters(apk):
    print '\n=Intent filters='
    for i_f in get_all_intent_filters(apk):
        print i_f


def display_permissions(apk):
    print '\n=Permissions='
    permissions = apk.get_permissions()
    print permissions
